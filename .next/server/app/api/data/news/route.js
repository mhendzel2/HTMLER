"use strict";(()=>{var e={};e.id=8756,e.ids=[8756],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},194:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>R,requestAsyncStorage:()=>y,routeModule:()=>g,serverHooks:()=>_,staticGenerationAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{GET:()=>h,POST:()=>k,dynamic:()=>u});var s=r(9303),n=r(8716),o=r(670),i=r(7070),c=r(3139);let u="force-dynamic",l=new Map,m=e=>({id:e.id||e.uuid||Math.random().toString(36).substr(2,9),title:e.title||e.headline||"No title available",content:e.content||e.summary||e.description,source:e.source||e.provider||"Unusual Whales",author:e.author||e.byline,timestamp:e.timestamp||e.published_at||e.date||new Date().toISOString(),url:e.url||e.link,tickers_mentioned:e.tickers_mentioned||e.symbols||e.tickers||[],sentiment_score:e.sentiment_score||e.sentiment,market_impact_score:e.market_impact_score||e.impact_score,image_url:e.image_url||e.image||e.thumbnail}),d=e=>{let t=l.get(e);return t?Date.now()-t.timestamp>3e5?(l.delete(e),null):t.data:null},p=(e,t)=>{l.set(e,{data:t,timestamp:Date.now()})};async function h(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("limit")||"50"),a=parseInt(t.get("page")||"0"),s=t.get("tickers")?.split(",").filter(Boolean),n=parseInt(t.get("hours")||"24"),o=t.get("category"),u=parseFloat(t.get("min_impact_score")||"0"),l=`news:${JSON.stringify({limit:r,page:a,tickers:s,hours:n,category:o,minImpactScore:u})}`,h=d(l);if(h)return i.NextResponse.json({news:h,totalCount:h.length,hasMore:h.length>=r,requestedTickers:s,lastUpdated:new Date().toISOString(),apiStatus:"connected",fromCache:!0});let k=[];try{if(s&&s.length>0){let e=s.map(async e=>{try{let t=await c.uy.getNewsHeadlines(Math.ceil(r/s.length),a,void 0,void 0,e);return(t.data||t||[]).map(m)}catch(t){return console.error(`Error fetching news for ticker ${e}:`,t),[]}});k=(await Promise.all(e)).flat();try{let e=await c.uy.getNewsHeadlines(r,a),t=(e.data||e||[]).map(m).filter(e=>e.tickers_mentioned?.some(e=>s.some(t=>e.toLowerCase().includes(t.toLowerCase()))));k=[...k,...t]}catch(e){console.error("Error fetching general news:",e)}}else{let e=await c.uy.getNewsHeadlines(r,a);k=(e.data||e||[]).map(m)}let e=k;if(n>0){let t=new Date(Date.now()-36e5*n);e=e.filter(e=>new Date(e.timestamp)>=t)}u>0&&(e=e.filter(e=>(e.market_impact_score||0)>=u));let t=e.filter((e,t,r)=>t===r.findIndex(t=>t.title===e.title));t.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());let o=t.slice(0,r);p(l,o);let d={news:o,totalCount:t.length,hasMore:t.length>r,requestedTickers:s,lastUpdated:new Date().toISOString(),apiStatus:"connected"};return i.NextResponse.json(d)}catch(e){return console.error("Unusual Whales News API Error:",e),i.NextResponse.json({news:[],totalCount:0,hasMore:!1,requestedTickers:s,lastUpdated:new Date().toISOString(),apiStatus:"error",error:e.message||"API request failed",errorStatus:e.status})}}catch(e){return console.error("News API Error:",e),i.NextResponse.json({error:"Failed to fetch news data",news:[],totalCount:0,hasMore:!1,apiStatus:"error",lastUpdated:new Date().toISOString()},{status:500})}}async function k(e){try{let{tickers:t,keywords:r,hours:a=24,minImpactScore:s=0}=await e.json();if(!t&&!r)return i.NextResponse.json({error:"Either tickers or keywords must be provided"},{status:400});let n=[];if(t&&Array.isArray(t)){let e=t.map(async e=>{try{let t=await c.uy.getNewsHeadlines(50,0,void 0,void 0,e);return(t.data||t||[]).map(m)}catch(t){return console.error(`Error fetching news for ticker ${e}:`,t),[]}});n=(await Promise.all(e)).flat()}if(r)try{let e=await c.uy.getNewsHeadlines(100,0),t=(e.data||e||[]).map(m).filter(e=>{let t=`${e.title} ${e.content||""}`.toLowerCase();return(Array.isArray(r)?r:[r]).some(e=>t.includes(e.toLowerCase()))});n=[...n,...t]}catch(e){console.error("Error fetching keyword-based news:",e)}let o=n,u=new Date(Date.now()-36e5*a);o=o.filter(e=>new Date(e.timestamp)>=u),s>0&&(o=o.filter(e=>(e.market_impact_score||0)>=s));let l=o.filter((e,t,r)=>t===r.findIndex(t=>t.title===e.title));return l.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),i.NextResponse.json({news:l,searchCriteria:{tickers:t,keywords:r,hours:a,minImpactScore:s},totalCount:l.length,apiStatus:"connected",timestamp:new Date().toISOString()})}catch(e){return console.error("POST news API error:",e),i.NextResponse.json({error:"Failed to search news data"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/data/news/route",pathname:"/api/data/news",filename:"route",bundlePath:"app/api/data/news/route"},resolvedPagePath:"C:\\Users\\mjhen\\HTER\\HTMLER\\app\\api\\data\\news\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:w,serverHooks:_}=g,f="/api/data/news/route";function R(){return(0,o.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:w})}},3139:(e,t,r)=>{r.d(t,{uy:()=>i});let a=process.env.UNUSUAL_WHALES_API_BASE_URL||"https://api.unusualwhales.com",s=process.env.UNUSUAL_WHALES_API_KEY;class n extends Error{constructor(e,t,r){super(e),this.status=t,this.response=r,this.name="UnusualWhalesAPIError"}}class o{constructor(){this.rateLimitDelay=100}static getInstance(){return o.instance||(o.instance=new o),o.instance}getHeaders(){let e={Accept:"application/json","Content-Type":"application/json"};return s&&(e.Authorization=`Bearer ${s}`),e}buildUrl(e,t){let r=new URL(`/api${e}`,a);return t&&Object.entries(t).forEach(([e,t])=>{null!=t&&r.searchParams.append(e,String(t))}),r.toString()}async makeRequest(e,t={}){let{method:r="GET",params:a,cache:s="default"}=t;await new Promise(e=>setTimeout(e,this.rateLimitDelay));let o=this.buildUrl(e,a);try{let e=await fetch(o,{method:r,headers:this.getHeaders(),cache:s});if(!e.ok){let t=await e.text().catch(()=>"Unknown error");throw new n(`API request failed: ${e.status} ${e.statusText}`,e.status,t)}return await e.json()}catch(e){if(e instanceof n)throw e;throw new n(`Network error: ${e instanceof Error?e.message:"Unknown error"}`)}}async getMarketTide(e,t=!0,r=!1){let a={};return e&&(a.date=e),a.interval_5m=t,a.otm_only=r,this.makeRequest("/market/market-tide",{params:a,cache:"no-store"})}async getSectorTide(e,t){let r=`/market/${encodeURIComponent(e)}/sector-tide`,a={};return t&&(a.date=t),this.makeRequest(r,{params:a,cache:"no-store"})}async getMarketCorrelations(e,t){let r={};return e&&(r.start_date=e),t&&(r.end_date=t),this.makeRequest("/market/correlations",{params:r})}async getEarningsAfterHours(e,t=50,r=0){let a={limit:t,page:r};return e&&(a.date=e),this.makeRequest("/earnings/afterhours",{params:a})}async getEarningsPreMarket(e,t=50,r=0){let a={limit:t,page:r};return e&&(a.date=e),this.makeRequest("/earnings/premarket",{params:a})}async getEarningsHistorical(e){return this.makeRequest(`/earnings/${e}`)}async getOptionContract(e){return this.makeRequest(`/option-contract/${e}`)}async getOptionContractIntraday(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/option-contract/${e}/intraday`,{params:r})}async getOptionContractVolumeProfile(e){return this.makeRequest(`/option-contract/${e}/volume-profile`)}async getStockOptionsData(e){return this.getStockFlowAlerts(e,!0,!0,50)}async getStockGreeks(e){return this.makeRequest(`/stock/${e}/greeks`)}async getStockOIPerStrike(e){return this.makeRequest(`/stock/${e}/oi-per-strike`)}async getStockOIPerExpiry(e){return this.makeRequest(`/stock/${e}/oi-per-expiry`)}async getStockOptionsVolume(e,t=1){return this.makeRequest(`/stock/${e}/options-volume`,{params:{limit:t}})}async getStockInfo(e){return this.makeRequest(`/stock/${e}`)}async getStockState(e){return this.makeRequest(`/stock/${e}/stock-state`)}async getStockNetPremTicks(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/stock/${e}/net-prem-ticks`,{params:r})}async getStockFlowAlerts(e,t=!0,r=!0,a=100){try{let t=await this.makeRequest("/option-trades/flow-alerts",{params:{limit:2*a}});return t?.data?.data&&(t.data.data=t.data.data.filter(t=>t.underlying_symbol===e.toUpperCase())),t}catch(e){return this.makeRequest("/market/oi-change",{params:{limit:50,page:0}})}}async getFlowAlerts(e=50){return this.makeRequest("/option-trades/flow-alerts",{params:{limit:e}})}async getStockGEX(e){return this.makeRequest(`/stock/${e}/gex`)}async getStockGreekFlow(e,t,r){let a={};return t&&(a.date=t),r&&(a.expiry=r),this.makeRequest(`/stock/${e}/greek-flow`,{params:a})}async getStockMaxPain(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/stock/${e}/max-pain`,{params:r})}async getStockNetPremTicksProcessed(e,t){try{let r=await this.getStockNetPremTicks(e,t);if(!r?.data?.data||!Array.isArray(r.data.data))return r;let{data:a}=r.data,s=["net_call_premium","net_call_volume","net_put_premium","net_put_volume"],n=[];return a.forEach((e,t)=>{e.net_call_premium=parseFloat(e.net_call_premium||"0"),e.net_put_premium=parseFloat(e.net_put_premium||"0"),e.net_call_volume=parseFloat(e.net_call_volume||"0"),e.net_put_volume=parseFloat(e.net_put_volume||"0"),0!==t&&s.forEach(r=>{e[r]=e[r]+n[t-1][r]}),n.push(e)}),{...r,data:{...r.data,data:n}}}catch(t){throw new n(`Failed to get processed net premium ticks for ${e}: ${t instanceof Error?t.message:"Unknown error"}`)}}async getCongressRecentTrades(e=100,t=0,r,a,s,n){let o={limit:e,offset:t};return r&&(o.start_date=r),a&&(o.end_date=a),s&&(o.ticker=s),n&&(o.congress_member=n),this.makeRequest("/congress/recent-trades",{params:o})}async getCongressTopTradedTickers(e=10,t,r){let a={limit:e};return t&&(a.start_date=t),r&&(a.end_date=r),this.makeRequest("/congress/top-traded-tickers",{params:a})}async getAlerts(e,t=!0,r=100,a=0,s,n){let o={intraday_only:t,limit:r,page:a};return e?.length&&e.forEach((e,t)=>{o[`config_ids[${t}]`]=e}),s?.length&&s.forEach((e,t)=>{o[`noti_types[${t}]`]=e}),n&&(o.ticker_symbols=n),this.makeRequest("/alerts",{params:o})}async getAlertConfigurations(){return this.makeRequest("/alerts/configuration")}async getNewsHeadlines(e=50,t=0,r,a,s){let n={limit:e,page:t};return r&&(n.start_date=r),a&&(n.end_date=a),s&&(n.ticker=s),this.makeRequest("/news/headlines",{params:n})}async getInstitutions(){return this.makeRequest("/institutions")}async getInstitutionHoldings(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/holdings`)}async getInstitutionActivity(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/activity`)}async getInstitutionSectors(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/sectors`)}async getETFInflowOutflow(e){return this.makeRequest(`/etfs/${e}/in_outflow`)}async getShortsData(e){return this.makeRequest(`/shorts/${e}/data`)}async getShortsVolumesByExchange(e){return this.makeRequest(`/shorts/${e}/volumes-by-exchange`)}async getShortsFTDs(e){return this.makeRequest(`/shorts/${e}/ftds`)}async getShortsInterestFloat(e){return this.makeRequest(`/shorts/${e}/interest-float`)}async getShortsVolumeAndRatio(e){return this.makeRequest(`/shorts/${e}/volume-and-ratio`)}async getMarketFDACalendar(e,t){let r={};return e&&(r.start_date=e),t&&(r.end_date=t),this.makeRequest("/market/fda-calendar",{params:r})}async getMarketOIChange(e=100,t=0){return this.makeRequest("/market/oi-change",{params:{limit:e,page:t}})}async getNetFlowExpiry(e,t,r,a){let s={};return e&&(s.ticker_symbol=e),t&&(s.tide_type=t),r&&(s.moneyness=r),a&&(s.expiry_category=a),this.makeRequest("/net-flow/expiry",{params:s})}async getStockInterpolatedIV(e,t){let r={};return t?.length&&t.forEach((e,t)=>{r[`days[${t}]`]=e}),this.makeRequest(`/stock/${e}/interpolated-iv`,{params:r})}async getStockNOPE(e){return this.makeRequest(`/stock/${e}/nope`)}async getStockSpotExposures(e,t,r){return t&&r?this.makeRequest(`/stock/${e}/spot-exposures/expiry-strike`,{params:{expiry:t,strike:r}}):this.makeRequest(`/stock/${e}/spot-exposures`)}async getDarkPoolData(e,t,r,a,s){let n={};return t&&(n.start_date=t),r&&(n.end_date=r),a&&(n.min_size=a),s&&(n.min_premium=s),this.makeRequest(`/stock/${e}/darkpool`,{params:n})}async getGroupFlowGreekFlow(e,t){let r=t?`/group-flow/${e}/greek-flow/${t}`:`/group-flow/${e}/greek-flow`;return this.makeRequest(r)}async getInstitutionLatestFilings(e=50,t=0){return this.makeRequest("/institution/latest_filings",{params:{limit:e,page:t}})}async getInstitutionOwnership(e){return this.makeRequest(`/institution/${e}/ownership`)}}let i=o.getInstance()}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972],()=>r(194));module.exports=a})();