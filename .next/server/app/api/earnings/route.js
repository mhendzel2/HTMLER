"use strict";(()=>{var e={};e.id=3700,e.ids=[3700],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4695:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>d,requestAsyncStorage:()=>k,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var s={};r.r(s),r.d(s,{GET:()=>l,dynamic:()=>c});var a=r(9303),n=r(8716),o=r(670),i=r(7070),u=r(3139);let c="force-dynamic";async function l(e){try{let t;let{searchParams:r}=new URL(e.url),s=r.get("type")||"afterhours",a=r.get("ticker"),n=r.get("date"),o=parseInt(r.get("limit")||"50"),c=parseInt(r.get("page")||"0");if("historical"===s&&a)t=await u.uy.getEarningsHistorical(a);else if("afterhours"===s)t=await u.uy.getEarningsAfterHours(n||void 0,o,c);else{if("premarket"!==s)return i.NextResponse.json({error:"Invalid type parameter or missing ticker for historical data"},{status:400});t=await u.uy.getEarningsPreMarket(n||void 0,o,c)}return i.NextResponse.json(t)}catch(e){return console.error("Earnings API error:",e),i.NextResponse.json({error:"Failed to fetch earnings data"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/earnings/route",pathname:"/api/earnings",filename:"route",bundlePath:"app/api/earnings/route"},resolvedPagePath:"C:\\Users\\mjhen\\HTER\\HTMLER\\app\\api\\earnings\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:k,staticGenerationAsyncStorage:p,serverHooks:g}=m,h="/api/earnings/route";function d(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},3139:(e,t,r)=>{r.d(t,{uy:()=>i});let s=process.env.UNUSUAL_WHALES_API_BASE_URL||"https://api.unusualwhales.com",a=process.env.UNUSUAL_WHALES_API_KEY;class n extends Error{constructor(e,t,r){super(e),this.status=t,this.response=r,this.name="UnusualWhalesAPIError"}}class o{constructor(){this.rateLimitDelay=100}static getInstance(){return o.instance||(o.instance=new o),o.instance}getHeaders(){let e={Accept:"application/json","Content-Type":"application/json"};return a&&(e.Authorization=`Bearer ${a}`),e}buildUrl(e,t){let r=new URL(`/api${e}`,s);return t&&Object.entries(t).forEach(([e,t])=>{null!=t&&r.searchParams.append(e,String(t))}),r.toString()}async makeRequest(e,t={}){let{method:r="GET",params:s,cache:a="default"}=t;await new Promise(e=>setTimeout(e,this.rateLimitDelay));let o=this.buildUrl(e,s);try{let e=await fetch(o,{method:r,headers:this.getHeaders(),cache:a});if(!e.ok){let t=await e.text().catch(()=>"Unknown error");throw new n(`API request failed: ${e.status} ${e.statusText}`,e.status,t)}return await e.json()}catch(e){if(e instanceof n)throw e;throw new n(`Network error: ${e instanceof Error?e.message:"Unknown error"}`)}}async getMarketTide(e,t=!0,r=!1){let s={};return e&&(s.date=e),s.interval_5m=t,s.otm_only=r,this.makeRequest("/market/market-tide",{params:s,cache:"no-store"})}async getSectorTide(e,t){let r=`/market/${encodeURIComponent(e)}/sector-tide`,s={};return t&&(s.date=t),this.makeRequest(r,{params:s,cache:"no-store"})}async getMarketCorrelations(e,t){let r={};return e&&(r.start_date=e),t&&(r.end_date=t),this.makeRequest("/market/correlations",{params:r})}async getEarningsAfterHours(e,t=50,r=0){let s={limit:t,page:r};return e&&(s.date=e),this.makeRequest("/earnings/afterhours",{params:s})}async getEarningsPreMarket(e,t=50,r=0){let s={limit:t,page:r};return e&&(s.date=e),this.makeRequest("/earnings/premarket",{params:s})}async getEarningsHistorical(e){return this.makeRequest(`/earnings/${e}`)}async getOptionContract(e){return this.makeRequest(`/option-contract/${e}`)}async getOptionContractIntraday(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/option-contract/${e}/intraday`,{params:r})}async getOptionContractVolumeProfile(e){return this.makeRequest(`/option-contract/${e}/volume-profile`)}async getStockOptionsData(e){return this.getStockFlowAlerts(e,!0,!0,50)}async getStockGreeks(e){return this.makeRequest(`/stock/${e}/greeks`)}async getStockOIPerStrike(e){return this.makeRequest(`/stock/${e}/oi-per-strike`)}async getStockOIPerExpiry(e){return this.makeRequest(`/stock/${e}/oi-per-expiry`)}async getStockOptionsVolume(e,t=1){return this.makeRequest(`/stock/${e}/options-volume`,{params:{limit:t}})}async getStockInfo(e){return this.makeRequest(`/stock/${e}`)}async getStockState(e){return this.makeRequest(`/stock/${e}/stock-state`)}async getStockNetPremTicks(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/stock/${e}/net-prem-ticks`,{params:r})}async getStockFlowAlerts(e,t=!0,r=!0,s=100){try{let t=await this.makeRequest("/option-trades/flow-alerts",{params:{limit:2*s}});return t?.data?.data&&(t.data.data=t.data.data.filter(t=>t.underlying_symbol===e.toUpperCase())),t}catch(e){return this.makeRequest("/market/oi-change",{params:{limit:50,page:0}})}}async getFlowAlerts(e=50){return this.makeRequest("/option-trades/flow-alerts",{params:{limit:e}})}async getStockGEX(e){return this.makeRequest(`/stock/${e}/gex`)}async getStockGreekFlow(e,t,r){let s={};return t&&(s.date=t),r&&(s.expiry=r),this.makeRequest(`/stock/${e}/greek-flow`,{params:s})}async getStockMaxPain(e,t){let r={};return t&&(r.date=t),this.makeRequest(`/stock/${e}/max-pain`,{params:r})}async getStockNetPremTicksProcessed(e,t){try{let r=await this.getStockNetPremTicks(e,t);if(!r?.data?.data||!Array.isArray(r.data.data))return r;let{data:s}=r.data,a=["net_call_premium","net_call_volume","net_put_premium","net_put_volume"],n=[];return s.forEach((e,t)=>{e.net_call_premium=parseFloat(e.net_call_premium||"0"),e.net_put_premium=parseFloat(e.net_put_premium||"0"),e.net_call_volume=parseFloat(e.net_call_volume||"0"),e.net_put_volume=parseFloat(e.net_put_volume||"0"),0!==t&&a.forEach(r=>{e[r]=e[r]+n[t-1][r]}),n.push(e)}),{...r,data:{...r.data,data:n}}}catch(t){throw new n(`Failed to get processed net premium ticks for ${e}: ${t instanceof Error?t.message:"Unknown error"}`)}}async getCongressRecentTrades(e=100,t=0,r,s,a,n){let o={limit:e,offset:t};return r&&(o.start_date=r),s&&(o.end_date=s),a&&(o.ticker=a),n&&(o.congress_member=n),this.makeRequest("/congress/recent-trades",{params:o})}async getCongressTopTradedTickers(e=10,t,r){let s={limit:e};return t&&(s.start_date=t),r&&(s.end_date=r),this.makeRequest("/congress/top-traded-tickers",{params:s})}async getAlerts(e,t=!0,r=100,s=0,a,n){let o={intraday_only:t,limit:r,page:s};return e?.length&&e.forEach((e,t)=>{o[`config_ids[${t}]`]=e}),a?.length&&a.forEach((e,t)=>{o[`noti_types[${t}]`]=e}),n&&(o.ticker_symbols=n),this.makeRequest("/alerts",{params:o})}async getAlertConfigurations(){return this.makeRequest("/alerts/configuration")}async getNewsHeadlines(e=50,t=0,r,s,a){let n={limit:e,page:t};return r&&(n.start_date=r),s&&(n.end_date=s),a&&(n.ticker=a),this.makeRequest("/news/headlines",{params:n})}async getInstitutions(){return this.makeRequest("/institutions")}async getInstitutionHoldings(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/holdings`)}async getInstitutionActivity(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/activity`)}async getInstitutionSectors(e){return this.makeRequest(`/institution/${encodeURIComponent(e)}/sectors`)}async getETFInflowOutflow(e){return this.makeRequest(`/etfs/${e}/in_outflow`)}async getShortsData(e){return this.makeRequest(`/shorts/${e}/data`)}async getShortsVolumesByExchange(e){return this.makeRequest(`/shorts/${e}/volumes-by-exchange`)}async getShortsFTDs(e){return this.makeRequest(`/shorts/${e}/ftds`)}async getShortsInterestFloat(e){return this.makeRequest(`/shorts/${e}/interest-float`)}async getShortsVolumeAndRatio(e){return this.makeRequest(`/shorts/${e}/volume-and-ratio`)}async getMarketFDACalendar(e,t){let r={};return e&&(r.start_date=e),t&&(r.end_date=t),this.makeRequest("/market/fda-calendar",{params:r})}async getMarketOIChange(e=100,t=0){return this.makeRequest("/market/oi-change",{params:{limit:e,page:t}})}async getNetFlowExpiry(e,t,r,s){let a={};return e&&(a.ticker_symbol=e),t&&(a.tide_type=t),r&&(a.moneyness=r),s&&(a.expiry_category=s),this.makeRequest("/net-flow/expiry",{params:a})}async getStockInterpolatedIV(e,t){let r={};return t?.length&&t.forEach((e,t)=>{r[`days[${t}]`]=e}),this.makeRequest(`/stock/${e}/interpolated-iv`,{params:r})}async getStockNOPE(e){return this.makeRequest(`/stock/${e}/nope`)}async getStockSpotExposures(e,t,r){return t&&r?this.makeRequest(`/stock/${e}/spot-exposures/expiry-strike`,{params:{expiry:t,strike:r}}):this.makeRequest(`/stock/${e}/spot-exposures`)}async getDarkPoolData(e,t,r,s,a){let n={};return t&&(n.start_date=t),r&&(n.end_date=r),s&&(n.min_size=s),a&&(n.min_premium=a),this.makeRequest(`/stock/${e}/darkpool`,{params:n})}async getGroupFlowGreekFlow(e,t){let r=t?`/group-flow/${e}/greek-flow/${t}`:`/group-flow/${e}/greek-flow`;return this.makeRequest(r)}async getInstitutionLatestFilings(e=50,t=0){return this.makeRequest("/institution/latest_filings",{params:{limit:e,page:t}})}async getInstitutionOwnership(e){return this.makeRequest(`/institution/${e}/ownership`)}}let i=o.getInstance()}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972],()=>r(4695));module.exports=s})();