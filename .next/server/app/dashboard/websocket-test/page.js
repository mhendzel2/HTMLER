(()=>{var e={};e.id=7469,e.ids=[7469],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4068:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>c.a,__next_app__:()=>u,originalPathname:()=>h,pages:()=>d,routeModule:()=>b,tree:()=>l}),t(3051),t(5688),t(7564),t(5866);var n=t(3191),r=t(8716),o=t(7922),c=t.n(o),a=t(5231),i={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>a[e]);t.d(s,i);let l=["",{children:["dashboard",{children:["websocket-test",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3051)),"C:\\Users\\mjhen\\HTER\\HTMLER\\app\\dashboard\\websocket-test\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5688)),"C:\\Users\\mjhen\\HTER\\HTMLER\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,7564)),"C:\\Users\\mjhen\\HTER\\HTMLER\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\mjhen\\HTER\\HTMLER\\app\\dashboard\\websocket-test\\page.tsx"],h="/dashboard/websocket-test/page",u={require:t,loadChunk:()=>Promise.resolve()},b=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/websocket-test/page",pathname:"/dashboard/websocket-test",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},9305:(e,s,t)=>{Promise.resolve().then(t.bind(t,2169))},2169:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var n=t(326),r=t(7577),o=t(3071),c=t(772),a=t(567),i=t(3273),l=t(361),d=t(5091);let h=(0,t(2881).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var u=t(949),b=t(3964);function p(){let[e,s]=(0,r.useState)(null),[t,p]=(0,r.useState)(!1),[g,m]=(0,r.useState)("disconnected"),[x,f]=(0,r.useState)(null),S=async()=>{p(!0),s(null);try{console.log("Starting WebSocket test...");let e=await b.n.testWebSocketAccess();if(console.log("WebSocket test results:",e),s(e),!e.hasWebSocketScope){console.log("Testing alternative endpoints...");try{let e=await fetch("/api/test-websocket-access");if(e.ok){let s=await e.json();console.log("Alternative test results:",s)}}catch(e){console.log("Alternative test failed:",e)}}}catch(e){console.error("WebSocket test error:",e),s({hasWebSocketScope:!1,availableChannels:[],error:`Test failed: ${e instanceof Error?e.message:"Unknown error"}`})}p(!1)},k=async()=>{m("connecting"),await b.n.connect();let e=setInterval(()=>{let s=b.n.getStatus();m(s),("connected"===s||"disconnected"===s)&&clearInterval(e)},500);setTimeout(()=>{clearInterval(e),b.n.disconnect(),m("disconnected")},1e4)};return(0,n.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"WebSocket Connection Test"}),n.jsx("p",{className:"text-muted-foreground",children:"Test your API access to WebSocket features and real-time data streams"})]}),(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsxs)(o.Zb,{children:[(0,n.jsxs)(o.Ol,{children:[n.jsx(o.ll,{children:"API Scope Verification"}),n.jsx(o.SZ,{children:"Check if your API key has access to WebSocket features"})]}),(0,n.jsxs)(o.aY,{className:"space-y-4",children:[n.jsx(c.z,{onClick:S,disabled:t,className:"w-full",children:t?"Testing API Access...":"Test WebSocket Scope"}),e&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(i.bZ,{className:e.hasWebSocketScope?"border-green-200":"border-red-200",children:[e.hasWebSocketScope?n.jsx(l.Z,{className:"h-4 w-4 text-green-500"}):n.jsx(h,{className:"h-4 w-4 text-red-500"}),(0,n.jsxs)(i.X,{children:[n.jsx("strong",{children:e.hasWebSocketScope?"WebSocket Access Available":"WebSocket Access Not Available"}),n.jsx("br",{}),e.error||(e.hasWebSocketScope?"Your API key has access to real-time WebSocket features.":"Your API plan does not include WebSocket access. The system will use polling instead.")]})]}),e.hasWebSocketScope&&e.availableChannels.length>0&&(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-semibold text-sm",children:"Available WebSocket Channels:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e.availableChannels.map((e,s)=>n.jsx(a.C,{variant:"outline",children:e},s))})]})]})]})]}),e?.hasWebSocketScope&&(0,n.jsxs)(o.Zb,{children:[(0,n.jsxs)(o.Ol,{children:[n.jsx(o.ll,{children:"WebSocket Connection Test"}),n.jsx(o.SZ,{children:"Test real-time connection to Unusual Whales WebSocket servers"})]}),(0,n.jsxs)(o.aY,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"connected":return n.jsx(l.Z,{className:"w-5 h-5 text-green-500"});case"connecting":return n.jsx(d.Z,{className:"w-5 h-5 text-yellow-500 animate-pulse"});default:return n.jsx(h,{className:"w-5 h-5 text-red-500"})}})(g),(0,n.jsxs)("span",{className:"font-medium",children:["Connection Status: ",g]})]}),n.jsx(c.z,{onClick:k,disabled:"connecting"===g,variant:"outline",children:"connecting"===g?"Connecting...":"Test Connection"})]}),"connected"===g&&(0,n.jsxs)(i.bZ,{className:"border-green-200",children:[n.jsx(l.Z,{className:"h-4 w-4 text-green-500"}),(0,n.jsxs)(i.X,{children:[n.jsx("strong",{children:"WebSocket Connected Successfully!"}),n.jsx("br",{}),"Real-time data streaming is now available. Connection will auto-disconnect in 10 seconds."]})]}),"disconnected"===g&&e&&(0,n.jsxs)(i.bZ,{children:[n.jsx(u.Z,{className:"h-4 w-4"}),(0,n.jsxs)(i.X,{children:["WebSocket connection failed or disconnected. This could be due to:",(0,n.jsxs)("ul",{className:"list-disc ml-4 mt-2",children:[n.jsx("li",{children:"Network connectivity issues"}),n.jsx("li",{children:"API key permissions"}),n.jsx("li",{children:"Server-side restrictions"})]}),"The system will fall back to polling mode for real-time updates."]})]})]})]}),(0,n.jsxs)(o.Zb,{children:[(0,n.jsxs)(o.Ol,{children:[n.jsx(o.ll,{children:"Next Steps"}),n.jsx(o.SZ,{children:"How to proceed based on your test results"})]}),n.jsx(o.aY,{children:n.jsx("div",{className:"space-y-4",children:e?.hasWebSocketScope?(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-semibold text-green-600",children:"✅ WebSocket Available"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"You can now use the Advanced Trading Filters with real-time monitoring. Navigate to the Trading Filters page to start monitoring institutional flow."}),n.jsx(c.z,{asChild:!0,children:n.jsx("a",{href:"/dashboard/filters",children:"Go to Trading Filters"})})]}):(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-semibold text-orange-600",children:"⚠️ Polling Mode Only"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Your API plan doesn't include WebSocket access, but you can still use the Trading Filters in polling mode. Updates will be fetched every 30 seconds to respect rate limits."}),n.jsx(c.z,{asChild:!0,variant:"outline",children:n.jsx("a",{href:"/dashboard/filters",children:"Use Trading Filters (Polling)"})})]})})})]})]})]})}},3273:(e,s,t)=>{"use strict";t.d(s,{X:()=>l,bZ:()=>i});var n=t(326),r=t(7577),o=t(8671),c=t(7863);let a=(0,o.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=r.forwardRef(({className:e,variant:s,...t},r)=>n.jsx("div",{ref:r,role:"alert",className:(0,c.cn)(a({variant:s}),e),...t}));i.displayName="Alert",r.forwardRef(({className:e,...s},t)=>n.jsx("h5",{ref:t,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";let l=r.forwardRef(({className:e,...s},t)=>n.jsx("div",{ref:t,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",e),...s}));l.displayName="AlertDescription"},567:(e,s,t)=>{"use strict";t.d(s,{C:()=>a});var n=t(326);t(7577);var r=t(8671),o=t(7863);let c=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a({className:e,variant:s,...t}){return n.jsx("div",{className:(0,o.cn)(c({variant:s}),e),...t})}},3964:(e,s,t)=>{"use strict";t.d(s,{n:()=>r});class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}async testWebSocketAccess(){try{let e=await fetch("/api/test-websocket-access",{method:"GET",headers:{Accept:"application/json"}}),s=await e.json();if(console.log("WebSocket test response:",s),s.hasWebSocketScope)return{hasWebSocketScope:!0,availableChannels:["gex_strike_expiry:<TICKER>","gex:TICKER","gex_strike:TICKER","price:TICKER","flow-alerts","news","option_trades","option_trades:<TICKER>"]};return{hasWebSocketScope:!1,availableChannels:[],error:s.message||s.error||"WebSocket access not available"}}catch(e){return console.error("WebSocket test error:",e),{hasWebSocketScope:!1,availableChannels:[],error:`WebSocket test failed: ${e instanceof Error?e.message:"Unknown error"}`}}}async connect(){if(this.isConnecting||this.ws?.readyState===WebSocket.OPEN)return!0;this.isConnecting=!0;try{let e=await this.testWebSocketAccess();if(!e.hasWebSocketScope)return console.warn("WebSocket access not available:",e.error),this.isConnecting=!1,!1;let s="wss://api.unusualwhales.com/ws";return console.log("Attempting WebSocket connection to:",s),this.ws=new WebSocket(s),new Promise(e=>{this.ws.onopen=()=>{console.log("WebSocket connected successfully"),this.reconnectAttempts=0,this.reconnectDelay=1e3,this.isConnecting=!1,e(!0)},this.ws.onmessage=e=>{try{let s=JSON.parse(e.data);console.log("WebSocket message received:",s),this.handleMessage(s)}catch(s){console.error("Failed to parse WebSocket message:",s,e.data)}},this.ws.onclose=e=>{console.log("WebSocket connection closed:",e.code,e.reason),this.ws=null,this.isConnecting=!1,1e3!==e.code&&this.handleReconnect()},this.ws.onerror=s=>{console.error("WebSocket error:",s),this.isConnecting=!1,e(!1)},setTimeout(()=>{this.isConnecting&&(console.log("WebSocket connection timeout"),this.isConnecting=!1,this.ws&&this.ws.close(),e(!1))},1e4)})}catch(e){return console.error("Failed to establish WebSocket connection:",e),this.isConnecting=!1,!1}}subscribe(e,s){this.subscriptions.has(e)||(this.subscriptions.set(e,new Set),this.ws?.readyState===WebSocket.OPEN&&(console.log("Subscribing to channel:",e),this.ws.send(JSON.stringify({type:"subscribe",channel:e})))),this.subscriptions.get(e).add(s)}unsubscribe(e,s){let t=this.subscriptions.get(e);t&&(s?(t.delete(s),0===t.size&&(this.subscriptions.delete(e),this.ws?.readyState===WebSocket.OPEN&&(console.log("Unsubscribing from channel:",e),this.ws.send(JSON.stringify({type:"unsubscribe",channel:e}))))):(this.subscriptions.delete(e),this.ws?.readyState===WebSocket.OPEN&&(console.log("Unsubscribing from channel:",e),this.ws.send(JSON.stringify({type:"unsubscribe",channel:e})))))}handleMessage(e){if(Array.isArray(e)&&e.length>=2){let[s,t]=e;console.log("Received WebSocket message:",{channel:s,payload:t}),this.subscriptions.has(s)&&this.subscriptions.get(s).forEach(e=>{try{e({channel:s,payload:t,timestamp:Date.now()})}catch(e){console.error("Error in WebSocket callback:",e)}})}else console.log("Received non-array WebSocket message:",e)}handleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}this.reconnectAttempts++,console.log(`Attempting to reconnect... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect()},this.reconnectDelay),this.reconnectDelay=Math.min(2*this.reconnectDelay,3e4)}subscribeToOptionTrades(e){this.subscribe("option_trades",e)}subscribeToTickerOptionTrades(e,s){this.subscribe(`option_trades:${e.toUpperCase()}`,s)}unsubscribeFromOptionTrades(e){this.unsubscribe("option_trades",e)}unsubscribeFromTickerOptionTrades(e,s){this.unsubscribe(`option_trades:${e.toUpperCase()}`,s)}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.subscriptions.clear(),this.reconnectAttempts=0}getStatus(){return this.ws?.readyState===WebSocket.OPEN?"connected":this.isConnecting?"connecting":"disconnected"}constructor(){this.ws=null,this.subscriptions=new Map,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.isConnecting=!1}}let r=n.getInstance()},361:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});let n=(0,t(2881).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},949:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});let n=(0,t(2881).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3051:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});let n=(0,t(8570).createProxy)(String.raw`C:\Users\mjhen\HTER\HTMLER\app\dashboard\websocket-test\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),n=s.X(0,[9276,2643,5524,9308],()=>t(4068));module.exports=n})();